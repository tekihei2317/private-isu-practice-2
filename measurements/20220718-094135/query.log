make[1]: Entering directory '/home/isucon/private_isu/webapp'
sudo pt-query-digest /var/log/mysql/mysql-slow.log

# 4s user time, 20ms system time, 29.39M rss, 35.29M vsz
# Current date: Mon Jul 18 09:41:41 2022
# Hostname: ip-172-31-32-108
# Files: /var/log/mysql/mysql-slow.log
# Overall: 53.42k total, 23 unique, 890.33 QPS, 0.29x concurrency ________
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time            18s     2us   131ms   329us     1ms     1ms    93us
# Lock time           66ms       0     2ms     1us     1us    15us     1us
# Rows sent        537.40k       0     208   10.30   19.46   32.46       0
# Rows examine       1.13M       0    1000   22.27  102.22   66.10       0
# Query size         9.17M      28     491  179.95  487.09  178.85   36.69

# Profile
# Rank Query ID                      Response time Calls R/Call V/M   Item
# ==== ============================= ============= ===== ====== ===== ====
#    1 0x6FAD71BF5D992C23F196040E...  6.9977 39.8% 10403 0.0007  0.00 SELECT comments users
#    2 0x1F39ADCF93F1FFA4A989FD63...  2.1891 12.5%  5719 0.0004  0.00 SELECT posts
#    3 0x9F2038550F51B0A3AB05CA52...  1.4530  8.3%   255 0.0057  0.00 INSERT comments
#    4 0xDA556F9115773A1A99AA0165...  1.3674  7.8% 12469 0.0001  0.00 ADMIN PREPARE
#    5 0x4087F945CD9D7D595FC97F84...  1.3026  7.4%   434 0.0030  0.03 SELECT posts
#    6 0x26489ECBE26887E480CA8067...  1.2202  6.9%   216 0.0056  0.00 INSERT users
#    7 0x009A61E5EFBD5A5E4097914B...  0.9174  5.2%   154 0.0060  0.00 INSERT posts
#    8 0xC28133A79AA1930DEF7CBFD3...  0.4896  2.8%  1174 0.0004  0.00 SELECT posts
#    9 0x62D61E6E287DFD1E7B02F8CD...  0.4547  2.6%  3008 0.0002  0.00 SELECT posts
#   10 0x396201721CD58410E070DA94...  0.2927  1.7%  2758 0.0001  0.00 SELECT users
#   11 0xA047A0D0BA167343E5B36786...  0.2217  1.3%  1739 0.0001  0.00 SELECT users
# MISC 0xMISC                         0.6701  3.8% 15091 0.0000   0.0 <12 ITEMS>

# Query 1: 173.38 QPS, 0.12x concurrency, ID 0x6FAD71BF5D992C23F196040EB7AB3C84 at byte 708262
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         19   10403
# Exec time     39      7s   111us    18ms   672us     2ms   736us   366us
# Lock time     37    24ms       0     2ms     2us     1us    26us     1us
# Rows sent     71 383.78k       0     208   37.78  192.76   65.62    3.89
# Rows examine  66 767.57k       0     416   75.55  381.65  131.19    7.70
# Query size    48   4.42M     354     491  445.46  487.09   61.74  463.90
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'comments'\G
#    SHOW CREATE TABLE `comments`\G
#    SHOW TABLE STATUS LIKE 'users'\G
#    SHOW CREATE TABLE `users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT comments.id, comments.post_id, comments.user_id, comments.comment, comments.created_at, users.id as u_id, users.account_name as u_account_name, users.passhash as u_passhash, users.authority as u_authority, users.del_flg as u_del_flg, users.created_at as u_created_at FROM `comments` join users on comments.user_id = users.id WHERE `post_id` in (12273, 12274, 12271, 12272, 12269, 12270, 10000, 9999, 9998, 9997, 9996, 9995, 9994, 9993, 9992, 9991, 9990, 9989, 9988, 9987)\G

# Query 2: 95.32 QPS, 0.04x concurrency, ID 0x1F39ADCF93F1FFA4A989FD63B899988B at byte 9409287
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         10    5719
# Exec time     12      2s   153us    10ms   382us   839us   454us   273us
# Lock time     20    13ms       0     1ms     2us     1us    16us     1us
# Rows sent     20 111.70k      20      20      20      20       0      20
# Rows examine  19 223.40k      40      40      40      40       0      40
# Query size    20   1.90M     349     349     349     349       0     349
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'posts'\G
#    SHOW CREATE TABLE `posts`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT posts.id, posts.user_id, posts.body, posts.created_at, posts.mime, users.id as u_id, users.account_name as u_account_name, users.passhash as u_passhash, users.authority as u_authority, users.del_flg as u_del_flg, users.created_at as u_created_at FROM `posts` straight_join users on posts.user_id = users.id ORDER BY `created_at` DESC limit 20\G

# Query 3: 4.25 QPS, 0.02x concurrency, ID 0x9F2038550F51B0A3AB05CA526E3FEDDC at byte 11587748
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     255
# Exec time      8      1s     3ms    19ms     6ms     9ms     2ms     5ms
# Lock time      0   327us     1us     2us     1us     1us       0     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  34.47k      91     204  138.44  174.84   25.05  136.99
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ###
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'comments'\G
#    SHOW CREATE TABLE `comments`\G
INSERT INTO `comments` (`post_id`, `user_id`, `comment`) VALUES ('9977',767,'ｱﾘｶﾞﾄ　ｴﾍ♪(*^・^)ノ ⌒☆(*^-^*) ﾎﾟｯ')\G

# Query 4: 207.82 QPS, 0.02x concurrency, ID 0xDA556F9115773A1A99AA0165670CE848 at byte 10102322
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         23   12469
# Exec time      7      1s    28us    10ms   109us   247us   239us    69us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     3 365.30k      30      30      30      30       0      30
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  ###############
#   1ms  #
#  10ms  #
# 100ms
#    1s
#  10s+
administrator command: Prepare\G

# Query 5: 7.36 QPS, 0.02x concurrency, ID 0x4087F945CD9D7D595FC97F845D5F590C at byte 7101563
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:17
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     434
# Exec time      7      1s   137us   131ms     3ms     6ms     9ms     2ms
# Lock time      1   908us       0   139us     2us     1us     8us     1us
# Rows sent      0     434       1       1       1       1       0       1
# Rows examine   0     434       1       1       1       1       0       1
# Query size     0  21.57k      49      51   50.90   49.17    0.19   49.17
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us  ######################
#   1ms  ################################################################
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'posts'\G
#    SHOW CREATE TABLE `posts`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT mime, imgdata FROM `posts` WHERE `id` = 3884\G

# Query 6: 3.60 QPS, 0.02x concurrency, ID 0x26489ECBE26887E480CA8067F971EA04 at byte 6726669
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     216
# Exec time      6      1s     3ms    21ms     6ms     9ms     2ms     5ms
# Lock time      0   313us     1us     3us     1us     1us       0     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  45.56k     216     216     216     216       0     216
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ###
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'users'\G
#    SHOW CREATE TABLE `users`\G
INSERT INTO `users` (`account_name`, `passhash`) VALUES ('3DkDUWj9ysl8jJZsOIgoYq5ZE','634ef48bd93542bf939849b712e7bfe4779009311d2f42f9d2d3be852a6fe3f71151fdc687feaf2e7a5f8fa21473f732d7d0e314314a05d5c91abbdb3576b3ae')\G

# Query 7: 2.57 QPS, 0.02x concurrency, ID 0x009A61E5EFBD5A5E4097914B4DBD1C07 at byte 6730089
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     154
# Exec time      5   917ms     3ms    27ms     6ms    10ms     3ms     5ms
# Lock time      0   372us     1us   151us     2us     1us    11us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  22.22k     105     211  147.77  183.58   22.84  143.84
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ####
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'posts'\G
#    SHOW CREATE TABLE `posts`\G
INSERT INTO `posts` (`user_id`, `mime`, `imgdata`, `body`) VALUES (283,'image/png','','ｵﾒﾃﾞﾀﾖｰﾖｰ!ｰ!( ･_･)/-------◎ ｲﾀｧ!!_x)')\G

# Query 8: 21.35 QPS, 0.01x concurrency, ID 0xC28133A79AA1930DEF7CBFD3B0D2D423 at byte 5790163
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:23 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          2    1174
# Exec time      2   490ms   190us     5ms   417us   972us   391us   301us
# Lock time      4     3ms       0   121us     2us     1us     6us     1us
# Rows sent      4  22.93k      20      20      20      20       0      20
# Rows examine   3  45.86k      40      40      40      40       0      40
# Query size     4 468.91k     409     409     409     409       0     409
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ###
#  10ms
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'posts'\G
#    SHOW CREATE TABLE `posts`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT posts.id, posts.user_id, posts.body, posts.created_at, posts.mime, users.id as u_id, users.account_name as u_account_name, users.passhash as u_passhash, users.authority as u_authority, users.del_flg as u_del_flg, users.created_at as u_created_at FROM `posts` straight_join users on posts.user_id = users.id WHERE `posts`.`created_at` <= '2016-01-02 11:46:21' ORDER BY `posts`.`created_at` DESC limit 20\G

# Query 9: 50.13 QPS, 0.01x concurrency, ID 0x62D61E6E287DFD1E7B02F8CD37E8531F at byte 15979687
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5    3008
# Exec time      2   455ms    62us     9ms   151us   301us   276us    98us
# Lock time     10     7ms     1us   244us     2us     1us     7us     1us
# Rows sent      0   2.94k       1       1       1       1       0       1
# Rows examine   0   2.94k       1       1       1       1       0       1
# Query size    10 995.73k     336     340  338.97  329.68       0  329.68
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us  ################################################
# 100us  ################################################################
#   1ms  #
#  10ms
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'posts'\G
#    SHOW CREATE TABLE `posts`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT posts.id, posts.user_id, posts.body, posts.created_at, posts.mime, users.id as u_id, users.account_name as u_account_name, users.passhash as u_passhash, users.authority as u_authority, users.del_flg as u_del_flg, users.created_at as u_created_at FROM `posts` straight_join users on posts.user_id = users.id WHERE posts.`id` = '9963'\G

# Query 10: 45.97 QPS, 0.00x concurrency, ID 0x396201721CD58410E070DA9421CA8C8D at byte 15563656
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5    2758
# Exec time      1   293ms    47us     6ms   106us   194us   206us    69us
# Lock time      7     5ms       0   254us     1us     1us     7us     1us
# Rows sent      0   2.69k       1       1       1       1       0       1
# Rows examine   0   2.69k       1       1       1       1       0       1
# Query size     1 102.28k      37      39   37.97   38.53    0.49   36.69
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  #########
#   1ms  #
#  10ms
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'users'\G
#    SHOW CREATE TABLE `users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM `users` WHERE `id` = 629\G

# Query 11: 28.98 QPS, 0.00x concurrency, ID 0xA047A0D0BA167343E5B367867F4BDDDD at byte 18210150
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2022-07-18T00:40:18 to 2022-07-18T00:41:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3    1739
# Exec time      1   222ms    54us     4ms   127us   287us   181us    89us
# Lock time      7     5ms       0   866us     2us     1us    21us     1us
# Rows sent      0   1.39k       0       1    0.82    0.99    0.38    0.99
# Rows examine   0   1.39k       0       1    0.82    0.99    0.38    0.99
# Query size     1 113.71k      62      83   66.96   76.28    4.60   62.76
# String:
# Hosts        localhost
# Users        isuconp
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  ################################
#   1ms  #
#  10ms
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS LIKE 'users'\G
#    SHOW CREATE TABLE `users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM users WHERE account_name = 'j1IECBxdWdJdqxbx44Ohl' AND del_flg = 0\G
make[1]: Leaving directory '/home/isucon/private_isu/webapp'
